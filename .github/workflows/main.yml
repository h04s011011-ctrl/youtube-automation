name: Nature Canvas 1-Min Master Production

on:

  repository_dispatch:

    types: [start-build]

    workflow_dispatch:  # ğŸ‘ˆ ã“ã‚Œã‚’3è¡Œç›®ã‚ãŸã‚Šã«è¿½åŠ 


jobs:

  render:

    runs-on: ubuntu-latest

    steps:

      - name: Checkout

        uses: actions/checkout@v4

      - name: Install FFmpeg

        run: sudo apt-get update && sudo apt-get install -y ffmpeg

      - name: Download All Assets

        run: |

          curl -L "${{ github.event.client_payload.v_url }}" -o v_source.mp4

          curl -L "${{ github.event.client_payload.a_url }}" -o a_source.mp3

      - name: Render Master Video

        run: |

          # æ¸¡ã•ã‚ŒãŸåº§æ¨™ã‚’ä½¿ã£ã¦FFmpegã§åˆæˆ

          POS="${{ github.event.client_payload.overlay_pos }}"

          

          ffmpeg -loop 1 -i base_image.jpg \

            -stream_loop -1 -i v_source.mp4 \

            -stream_loop -1 -i a_source.mp3 \

            -filter_complex \

            "[1:v]scale=800:-1[over]; [0:v][over]overlay=$POS:shortest=1[outv]; \

             [2:a]afade=t=in:st=0:d=2,afade=t=out:st=58:d=2[aout]" \

            -map "[outv]" -map "[aout]" -t 60 -c:v libx264 -pix_fmt yuv420p output.mp4

      - name: Upload Artifact

        uses: actions/upload-artifact@v4

        with:

          name: Nature-Canvas-Template-Result

          path: output.mp4

```
