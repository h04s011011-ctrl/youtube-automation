name: Create 8-hour Video
on:
  repository_dispatch:
    types: [start-build]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Install FFmpeg
        run: sudo apt-get install ffmpeg
      - name: Download Assets and Render
        run: |
          # iPhoneから送られたURLを使ってダウンロード
          curl -L "${{ github.event.client_payload.sound_url }}" -o sound.mp3
          curl -L "${{ github.event.client_payload.image_url }}" -o image.jpg
          
          # FFmpegで画像をループさせ、音声を無限ループさせて合成（テスト用に短く設定）
          ffmpeg -loop 1 -i image.jpg -i sound.mp3 -c:v libx264 -t 60 -pix_fmt yuv420p output.mp4
